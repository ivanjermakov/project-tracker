-- TODO: rewrite repository methods to using PSQL stored procedures