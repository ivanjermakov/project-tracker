<app-header></app-header>
<div class="content-container" *ngIf="project && me && tasks">
	<div class="project">
		<div class="header-container">
			<div class="header">
				<div class="is-open-status"
				     [ngClass]="{'editing': editMode}"
				     (click)="editMode ? project.isPublic = !project.isPublic : null">
					<i class="fas fa-unlock-alt public-wrapper"
					   *ngIf="project.isPublic === true"></i>
					<i class="fas fa-lock private-wrapper"
					   *ngIf="project.isPublic === false"></i>
				</div>
				<div class="name">
					<div class="text"
					     [routerLink]="'/' + me.login">
						{{me.login}}
					</div>
					<div class="text name-delimiter">/</div>
					<div class="text"
					     [ngClass]="{'editing': editMode}"
					     [contentEditable]="editMode"
					     [routerLink]="'/' + me.login + '/' + project.name"
					     [textContent]="project.name"
					     (input)="project.name = $event.target.textContent">
						{{project.name}}
					</div>
				</div>
				<div class="edit" title="Edit project"
				     *ngIf="!editMode"
				     (click)="edit()">
					<i class="fas fa-pen"></i>
				</div>
				<div class="created">
					<div class="text">created on {{formatDateWithTime(project.created)}}</div>
				</div>
			</div>
		</div>
		<div class="description-container"
		     *ngIf="(project.description && project.description.length != 0) || editMode">
			<div class="description">Description</div>
			<div class="text"
			     [ngClass]="{'editing': editMode}"
			     [contentEditable]="editMode"
			     [textContent]="project.description"
			     (input)="project.description = $event.target.textContent">
				{{project.description}}
			</div>
		</div>
		<div class="delimiter"></div>
		<div class="tasks-container"
		     *ngIf="!editMode">
			<div class="tasks-header">
				<div class="tasks">Tasks</div>
				<button class="new-task-button" [routerLink]="'task/create'" title="New task">
					<i class="fas fa-plus"></i>
				</button>
			</div>
			<table class="tasks-table" *ngIf="tasks.length !== 0">
				<tr>
					<th>Id</th>
					<th>Name</th>
					<th>Project</th>
					<th>Type</th>
					<th>Estimate</th>
					<th>Elapsed</th>
					<th>Opened</th>
					<th>Due</th>
				</tr>
				<tr class="row" *ngFor="let t of tasks"
				    [routerLink]="'/' + project.user.login + '/' + project.name + '/task/' + t.id">
					<td>#{{t.id}}</td>
					<td>{{t.name}}</td>
					<td>{{t.project.name}}</td>
					<td>
						<div class="task-type-icon">
							<i class="fas fa-bolt feature" title="feature" *ngIf="t.type === 'FEATURE'"></i>
							<i class="fas fa-exclamation-triangle issue" title="issue" *ngIf="t.type === 'ISSUE'"></i>
							<i class="fas fa-bug bug" title="bug" *ngIf="t.type === 'BUG'"></i>
							<i class="fas fa-info request" title="request" *ngIf="t.type === 'REQUEST'"></i>
						</div>
					</td>
					<td>{{t.estimate ? t.estimate + 'h' : '-'}}</td>
					<td>{{t.elapsed ? t.elapsed : '-'}}</td>
					<td>{{formatDate(t.opened)}}</td>
					<td>{{t.due ? formatDate(t.due) : '-'}}</td>
				</tr>
			</table>
			<div *ngIf="tasks.length === 0" class="no-tasks">No tasks yet.</div>
		</div>
		<div class="delimiter" *ngIf="!editMode"></div>
		<div class="about-container"
		     *ngIf="(project.about && project.about.length != 0) || editMode">
			<div class="about">About</div>
			<div class="text"
			     [ngClass]="{'editing': editMode}"
			     [contentEditable]="editMode"
			     [textContent]="project.about"
			     (input)="project.about = $event.target.textContent">{{project.about}}</div>
		</div>
		<div class="edit-choice"
		     *ngIf="editMode">
			<button
					(click)="applyEdit()">Apply
			</button>
			<div class="cancel"
			     (click)="cancelEdit()">Cancel
			</div>
		</div>
	</div>
</div>
